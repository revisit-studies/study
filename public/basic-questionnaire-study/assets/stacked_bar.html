<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://d3js.org/d3.v7.js"></script>
</head>

<body>
    <svg>
    </svg>
</body>

<script>
    height = 500;
    width = 500;
    padding = 25;
    svg = d3.select("svg");
    svg.attr("width", width + 2 * padding)
        .attr("height", height + 2 * padding);

    let data = [0.32, -0.36, 1.2, -1.3, 0.82, 0.4, -0.3];
    var fulldata = d3.csvParse("shown,value\nhidden,0.32\nhidden,-0.36\nhidden,1.2\nvisible,-1.3\nhidden,0.82\nvisible,0.4\nhidden,-0.3")

    let selected = ["hidden","hidden","hidden","visible","hidden","visible","hidden"];
    let spacing = height / data.length;

    let min = -2;
    let max = 2;

    let yScale = d3.scaleLinear()
    .domain([min, max])
    .range([height-padding, padding])
    .nice();

    let color = "white";

    svg.selectAll(".bar")
        .data(fulldata)
        .join("rect")
            .classed("bar", true)
            .attr("transform", "translate(" + padding + "," + padding + ")")
            .attr("x", (d, i) => i * spacing + 5)
            .attr("y", d => yScale(Math.max(0,d.value)))
            .attr("width", 50)
            .attr("height", d => Math.abs(yScale(0)-yScale(d.value)))
            .style("fill", 'white')
            .style("stroke", "black");

    svg.selectAll(".barlabel")
        .data(fulldata)
        .join("circle")
        .classed("barlabel", true)
        .attr("transform", "translate(" + padding + "," + padding + ")")
        .attr("cx", (d, i) => (i * spacing + 5)+25)
        .attr("cy",d => yScale(d.value/2))
        .attr("r", 10)
        .attr("visibility",d => d.shown)
        .attr("stroke", "white")
        .attr("fill", "black");


    svg.append("g")
        .attr("transform", "translate(" + padding + "," + (height + padding) + ")")
        //.call(xAxis);

    svg.append("line")
        .attr("x1",padding)
        .attr("x2",width)
        .attr("y1",height/2+padding)
        .attr("y2",height/2+padding)
        .attr("stroke","black");
</script>
</html>